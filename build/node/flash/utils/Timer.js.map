{"version":3,"sources":["flash/utils/Timer.ts"],"names":["Timer","Timer.constructor","Timer.currentCount","Timer.delay","Timer.repeatCount","Timer.running","Timer.reset","Timer.start","Timer.stop","Timer.dispose","Timer.___timerCallback","Timer.___raiseTimerEvent","Timer.___raiseTimerCompleteEvent"],"mappings":"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","file":"flash/utils/Timer.js","sourcesContent":["/**\r\n * Created by MIC on 2016/1/7.\r\n */\r\n\r\nimport {EventDispatcher} from \"../events/EventDispatcher\";\r\nimport {IDisposable} from \"../../IDisposable\";\r\nimport {TimerEvent} from \"../events/TimerEvent\";\r\n\r\nexport class Timer extends EventDispatcher {\r\n\r\n    constructor(delay:number, repeatCount:number = 0) {\r\n        super();\r\n        this.delay = delay;\r\n        this.repeatCount = repeatCount;\r\n        this.start();\r\n    }\r\n\r\n    get currentCount():number {\r\n        return this._currentCount;\r\n    }\r\n\r\n    get delay():number {\r\n        return this._delay;\r\n    }\r\n\r\n    set delay(v:number) {\r\n        v = Math.floor(v);\r\n        this._delay = v >= 0 ? v : 0;\r\n    }\r\n\r\n    enabled:boolean = true;\r\n\r\n    get repeatCount():number {\r\n        return this._repeatCount;\r\n    }\r\n\r\n    set repeatCount(v:number) {\r\n        v = Math.floor(v);\r\n        this._repeatCount = v >= 0 ? v : 0;\r\n    }\r\n\r\n    get running():boolean {\r\n        return this._running;\r\n    }\r\n\r\n    reset():void {\r\n        if (this.running) {\r\n            window.clearInterval(this._handle);\r\n            this._handle = 0;\r\n            this._running = false;\r\n            this._currentCount = 0;\r\n        }\r\n    }\r\n\r\n    start():void {\r\n        if (!this.running && (this.currentCount < this.repeatCount || this.repeatCount === 0)) {\r\n            this._handle = window.setInterval(this.__timerCallback.bind(this), this.delay);\r\n            this._running = true;\r\n        }\r\n    }\r\n\r\n    stop():void {\r\n        if (this.running) {\r\n            window.clearInterval(this._handle);\r\n            this._handle = 0;\r\n            this._running = false;\r\n        }\r\n    }\r\n\r\n    dispose():void {\r\n        super.dispose();\r\n        this.reset();\r\n    }\r\n\r\n    protected __timerCallback():void {\r\n        if (this.enabled) {\r\n            this._currentCount++;\r\n            if (this.repeatCount > 0 && this.currentCount > this.repeatCount) {\r\n                this.stop();\r\n                this.__raiseTimerCompleteEvent();\r\n            } else {\r\n                this.__raiseTimerEvent();\r\n            }\r\n        }\r\n    }\r\n\r\n    protected __raiseTimerEvent():void {\r\n        var ev = new TimerEvent(TimerEvent.TIMER);\r\n        ev.timeStamp = Date.now();\r\n        this.dispatchEvent(ev);\r\n    }\r\n\r\n    protected __raiseTimerCompleteEvent():void {\r\n        var ev = new TimerEvent(TimerEvent.TIMER_COMPLETE);\r\n        ev.timeStamp = Date.now();\r\n        this.dispatchEvent(ev);\r\n    }\r\n\r\n    private _currentCount:number = 0;\r\n    private _delay:number = 1000;\r\n    private _repeatCount:number = 0;\r\n    private _running:boolean = false;\r\n    private _handle:number = 0;\r\n\r\n}\r\n"],"sourceRoot":"/source/"}