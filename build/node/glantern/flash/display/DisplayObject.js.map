{"version":3,"sources":["glantern/flash/display/displayobject.ts"],"names":["DisplayObject","DisplayObject.constructor","DisplayObject.alpha","DisplayObject.cacheAsBitmap","DisplayObject.childIndex","DisplayObject.dispose","DisplayObject.filters","DisplayObject.height","DisplayObject.mouseX","DisplayObject.mouseY","DisplayObject.name","DisplayObject.parent","DisplayObject.root","DisplayObject.rotation","DisplayObject.rotationX","DisplayObject.rotationY","DisplayObject.rotationZ","DisplayObject.stage","DisplayObject.transform","DisplayObject.width","DisplayObject.x","DisplayObject.y","DisplayObject.z","DisplayObject.getBounds","DisplayObject.getRect","DisplayObject.update","DisplayObject.render","DisplayObject.requestUpdateTransform","DisplayObject.___updateTransform","DisplayObject.___preprocess","DisplayObject.___postprocess","DisplayObject.___createFilterTarget","DisplayObject.___releaseFilterTarget","DisplayObject.___shouldProcessFilters"],"mappings":"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","file":"glantern/flash/display/DisplayObject.js","sourcesContent":["/**\r\n * Created by MIC on 2015/11/18.\r\n */\r\n\r\nimport {Stage} from \"./Stage\";\r\nimport {DisplayObjectContainer} from \"./DisplayObjectContainer\";\r\nimport {Transform} from \"../geom/Transform\";\r\nimport {WebGLRenderer} from \"../../webgl/WebGLRenderer\";\r\nimport {Rectangle} from \"../geom/Rectangle\";\r\nimport {IWebGLElement} from \"../../webgl/IWebGLElement\";\r\nimport {IBitmapDrawable} from \"./IBitmapDrawable\";\r\nimport {EventDispatcher} from \"../events/EventDispatcher\";\r\nimport {BlendMode} from \"./BlendMode\";\r\nimport {RenderTarget2D} from \"../../webgl/RenderTarget2D\";\r\nimport {ShaderID} from \"../../webgl/ShaderID\";\r\nimport {ShaderManager} from \"../../webgl/ShaderManager\";\r\nimport {UniformCache} from \"../../webgl/UniformCache\";\r\nimport {BitmapFilter} from \"../filters/BitmapFilter\";\r\nimport {Point} from \"../geom/Point\";\r\nimport {Matrix3D} from \"../geom/Matrix3D\";\r\nimport {Vector3D} from \"../geom/Vector3D\";\r\nimport {NotImplementedError} from \"../../../../lib/glantern-utils/src/NotImplementedError\";\r\nimport {GLUtil} from \"../../../../lib/glantern-utils/src/GLUtil\";\r\n\r\nexport abstract class DisplayObject extends EventDispatcher implements IBitmapDrawable, IWebGLElement {\r\n\r\n    constructor(root:Stage, parent:DisplayObjectContainer) {\r\n        super();\r\n        this._root = root;\r\n        this._stage = root;\r\n        this._parent = parent;\r\n        this._filters = [];\r\n        this._transform = new Transform();\r\n        this._isRoot = root === null;\r\n    }\r\n\r\n    get alpha():number {\r\n        return this._alpha;\r\n    }\r\n\r\n    set alpha(v:number) {\r\n        this._alpha = GLUtil.limitInto(v, 0, 1);\r\n    }\r\n\r\n    blendMode:string = BlendMode.NORMAL;\r\n\r\n    get cacheAsBitmap():boolean {\r\n        throw new NotImplementedError();\r\n    }\r\n\r\n    set cacheAsBitmap(v:boolean) {\r\n        throw new NotImplementedError();\r\n    }\r\n\r\n    get childIndex():number {\r\n        return this._childIndex;\r\n    }\r\n\r\n    // DO NOT call manually\r\n    set childIndex(v:number) {\r\n        this._childIndex = v;\r\n    }\r\n\r\n    dispose():void {\r\n        super.dispose();\r\n        this.filters = [];\r\n    }\r\n\r\n    enabled:boolean = true;\r\n\r\n    get filters():BitmapFilter[] {\r\n        return this._filters.slice();\r\n    }\r\n\r\n    set filters(v:BitmapFilter[]) {\r\n        var i:number;\r\n        var hasFiltersBefore = this.__shouldProcessFilters();\r\n        if (hasFiltersBefore) {\r\n            for (i = 0; i < this._filters.length; ++i) {\r\n                this._filters[i].notifyRemoved();\r\n            }\r\n        }\r\n        this._filters = v;\r\n        var hasFiltersNow = this.__shouldProcessFilters();\r\n        if (hasFiltersNow) {\r\n            for (i = 0; i < this._filters.length; ++i) {\r\n                this._filters[i].notifyAdded();\r\n            }\r\n        }\r\n        if (hasFiltersNow !== hasFiltersBefore) {\r\n            if (hasFiltersNow) {\r\n                this.__createFilterTarget(this._root.worldRenderer);\r\n            } else {\r\n                this.__releaseFilterTarget();\r\n            }\r\n        }\r\n    }\r\n\r\n    get height():number {\r\n        return this._height;\r\n    }\r\n\r\n    set height(v:number) {\r\n        this._height = v;\r\n    }\r\n\r\n    mask:DisplayObject = null;\r\n\r\n    get mouseX():number {\r\n        throw new NotImplementedError();\r\n    }\r\n\r\n    get mouseY():number {\r\n        throw new NotImplementedError();\r\n    }\r\n\r\n    get name():string {\r\n        return this._name;\r\n    }\r\n\r\n    set name(v:string) {\r\n        this._name = v;\r\n    }\r\n\r\n    get parent():DisplayObjectContainer {\r\n        return this._parent;\r\n    }\r\n\r\n    get root():DisplayObject {\r\n        return this._root;\r\n    }\r\n\r\n    get rotation():number {\r\n        return this._rotation;\r\n    }\r\n\r\n    set rotation(v:number) {\r\n        while (v < -180) {\r\n            v += 360;\r\n        }\r\n        while (v > 180) {\r\n            v -= 360;\r\n        }\r\n        this._rotation = v;\r\n    }\r\n\r\n    get rotationX():number {\r\n        return this._rotationX;\r\n    }\r\n\r\n    set rotationX(v:number) {\r\n        while (v < -180) {\r\n            v += 360;\r\n        }\r\n        while (v > 180) {\r\n            v -= 360;\r\n        }\r\n        this._rotationX = v;\r\n    }\r\n\r\n    get rotationY():number {\r\n        return this._rotationY;\r\n    }\r\n\r\n    set rotationY(v:number) {\r\n        while (v < -180) {\r\n            v += 360;\r\n        }\r\n        while (v > 180) {\r\n            v -= 360;\r\n        }\r\n        this._rotationY = v;\r\n    }\r\n\r\n    get rotationZ():number {\r\n        return this._rotationZ;\r\n    }\r\n\r\n    set rotationZ(v:number) {\r\n        while (v < -180) {\r\n            v += 360;\r\n        }\r\n        while (v > 180) {\r\n            v -= 360;\r\n        }\r\n        this._rotationZ = v;\r\n    }\r\n\r\n    get stage():Stage {\r\n        return this._stage;\r\n    }\r\n\r\n    get transform():Transform {\r\n        return this._transform;\r\n    }\r\n\r\n    visible:boolean = true;\r\n\r\n    get width():number {\r\n        return this._width;\r\n    }\r\n\r\n    set width(v:number) {\r\n        this._width = v;\r\n    }\r\n\r\n    get x():number {\r\n        return this._x;\r\n    }\r\n\r\n    set x(v:number) {\r\n        var b = this._x !== v;\r\n        this._x = v;\r\n        if (b) {\r\n            this.requestUpdateTransform();\r\n        }\r\n    }\r\n\r\n    get y():number {\r\n        return this._y;\r\n    }\r\n\r\n    set y(v:number) {\r\n        var b = this._y !== v;\r\n        this._y = v;\r\n        if (b) {\r\n            this.requestUpdateTransform();\r\n        }\r\n    }\r\n\r\n    get z():number {\r\n        return this._z;\r\n    }\r\n\r\n    set z(v:number) {\r\n        var b = this._z !== v;\r\n        this._z = v;\r\n        if (b) {\r\n            this.requestUpdateTransform();\r\n        }\r\n    }\r\n\r\n    getBounds(targetCoordinateSpace:DisplayObject):Rectangle {\r\n        throw new NotImplementedError();\r\n    }\r\n\r\n    getRect(targetCoordinateSpace:DisplayObject):Rectangle {\r\n        throw new NotImplementedError();\r\n    }\r\n\r\n    update():void {\r\n        if (this._isTransformDirty) {\r\n            this.__updateTransform();\r\n        }\r\n        if (this.enabled) {\r\n            this.__update();\r\n        }\r\n    }\r\n\r\n    render(renderer:WebGLRenderer):void {\r\n        if (this.visible && this.alpha > 0) {\r\n            this.__preprocess(renderer);\r\n            this.__render(renderer);\r\n            this.__postprocess(renderer);\r\n        } else {\r\n            //this.outputRenderTarget.clear();\r\n        }\r\n    }\r\n\r\n    requestUpdateTransform():void {\r\n        this._isTransformDirty = true;\r\n    }\r\n\r\n    protected __updateTransform():void {\r\n        var matrix3D:Matrix3D;\r\n        if (this._isRoot) {\r\n            matrix3D = new Matrix3D();\r\n        } else {\r\n            matrix3D = this.parent.transform.matrix3D.clone();\r\n        }\r\n        matrix3D.prependTranslation(this.x, this.y, this.z);\r\n        matrix3D.prependRotation(this.rotationX, Vector3D.X_AXIS);\r\n        matrix3D.prependRotation(this.rotationY, Vector3D.Y_AXIS);\r\n        matrix3D.prependRotation(this.rotationZ, Vector3D.Z_AXIS);\r\n        this.transform.matrix3D.copyFrom(matrix3D);\r\n    }\r\n\r\n    protected abstract __update():void;\r\n\r\n    protected abstract __render(renderer:WebGLRenderer):void;\r\n\r\n    /**\r\n     * Override this function to select the proper shader.\r\n     * @param shaderManager {ShaderManager} The shader manager.\r\n     * @example\r\n     * protected __selectShader(shaderManager: ShaderManager): void {\r\n     * &nbsp;&nbsp;shaderManager.selectShader(ShaderID.PRIMITIVE);\r\n     * }\r\n     */\r\n    protected abstract __selectShader(shaderManager:ShaderManager):void;\r\n\r\n    protected __preprocess(renderer:WebGLRenderer):void {\r\n        if (this.__shouldProcessFilters()) {\r\n            this._filterTarget.clear();\r\n            renderer.setRenderTarget(this._filterTarget);\r\n        } else {\r\n            renderer.setRenderTarget(null);\r\n        }\r\n        var manager = renderer.shaderManager;\r\n        this.__selectShader(manager);\r\n        var shader = manager.currentShader;\r\n        if (!GLUtil.isUndefinedOrNull(shader)) {\r\n            shader.changeValue(\"uTransformMatrix\", (u:UniformCache):void => {\r\n                u.value = this.transform.matrix3D.toArray();\r\n            });\r\n            shader.changeValue(\"uAlpha\", (u:UniformCache):void => {\r\n                u.value = this.alpha;\r\n            });\r\n        }\r\n        renderer.setBlendMode(this.blendMode);\r\n    }\r\n\r\n    protected __postprocess(renderer:WebGLRenderer):void {\r\n        if (this.__shouldProcessFilters()) {\r\n            var filterManager = renderer.filterManager;\r\n            filterManager.pushFilterGroup(this.filters);\r\n            filterManager.processFilters(renderer, this._filterTarget, renderer.screenTarget, false);\r\n            filterManager.popFilterGroup();\r\n        }\r\n    }\r\n\r\n    protected __createFilterTarget(renderer:WebGLRenderer):void {\r\n        if (this._filterTarget !== null) {\r\n            return;\r\n        }\r\n        this._filterTarget = renderer.createRenderTarget();\r\n    }\r\n\r\n    protected __releaseFilterTarget():void {\r\n        if (this._filterTarget === null) {\r\n            return;\r\n        }\r\n        this._root.worldRenderer.releaseRenderTarget(this._filterTarget);\r\n        this._filterTarget = null;\r\n    }\r\n\r\n    private __shouldProcessFilters():boolean {\r\n        return this.filters !== null && this.filters.length > 0;\r\n    }\r\n\r\n    protected _parent:DisplayObjectContainer = null;\r\n    protected _root:Stage = null;\r\n    protected _name:string = \"\";\r\n    protected _rotation:number = 0;\r\n    protected _rotationX:number = 0;\r\n    protected _rotationY:number = 0;\r\n    protected _rotationZ:number = 0;\r\n    protected _scaleX:number = 1;\r\n    protected _scaleY:number = 1;\r\n    protected _scaleZ:number = 1;\r\n    protected _stage:Stage = null;\r\n    protected _height:number = 0;\r\n    protected _width:number = 0;\r\n    protected _x:number = 0;\r\n    protected _y:number = 0;\r\n    protected _z:number = 0;\r\n    protected _childIndex:number = -1;\r\n    protected _alpha:number = 1;\r\n    protected _filters:BitmapFilter[] = null;\r\n    protected _filterTarget:RenderTarget2D = null;\r\n    protected _transform:Transform = null;\r\n    protected _isTransformDirty:boolean = true;\r\n    private _isRoot:boolean = false;\r\n\r\n}\r\n"],"sourceRoot":"/source/"}