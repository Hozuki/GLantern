{"version":3,"sources":["GLantern.ts"],"names":["GLantern","GLantern.constructor","GLantern.initialize","GLantern.dispose","GLantern.startAnimation","GLantern.stopAnimation","GLantern.clear","GLantern.runOneFrame","GLantern.stage","GLantern.renderer","GLantern.view","GLantern.attachUpdateFunction","GLantern.___mainLoop"],"mappings":"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","file":"GLantern.js","sourcesContent":["/**\r\n * Created by MIC on 2015/11/25.\r\n */\r\n\r\nimport {WebGLRenderer} from \"./webgl/WebGLRenderer\";\r\nimport {Stage} from \"./flash/display/Stage\";\r\nimport {RendererOptions} from \"./webgl/RendererOptions\";\r\nimport {_util} from \"./_util/_util\";\r\nimport {FlashEvent} from \"./flash/events/FlashEvent\";\r\nimport {IDisposable} from \"./IDisposable\";\r\n\r\nexport class GLantern implements IDisposable {\r\n\r\n    constructor() {\r\n    }\r\n\r\n    initialize(width:number, height:number, options:RendererOptions = WebGLRenderer.DEFAULT_OPTIONS):void {\r\n        if (this._isInitialized) {\r\n            return;\r\n        }\r\n        this._renderer = new WebGLRenderer(width, height, options);\r\n        this._stage = new Stage(this._renderer);\r\n        this._isInitialized = true;\r\n    }\r\n\r\n    dispose():void {\r\n        if (!this._isInitialized) {\r\n            return;\r\n        }\r\n        this._stage.dispose();\r\n        this._renderer.dispose();\r\n        this._stage = null;\r\n        this._renderer = null;\r\n        this._isInitialized = false;\r\n    }\r\n\r\n    startAnimation():void {\r\n        if (!this._isInitialized) {\r\n            return;\r\n        }\r\n        this._isRunning = true;\r\n        _util.requestAnimationFrame(this.__mainLoop.bind(this));\r\n    }\r\n\r\n    stopAnimation():void {\r\n        if (!this._isInitialized) {\r\n            return;\r\n        }\r\n        this._isRunning = false;\r\n    }\r\n\r\n    clear():void {\r\n        this._renderer.clear();\r\n    }\r\n\r\n    runOneFrame():void {\r\n        if (!this._isInitialized) {\r\n            return;\r\n        }\r\n        this._stage.dispatchEvent(FlashEvent.create(FlashEvent.ENTER_FRAME));\r\n        if (this._attachedUpdateFunction !== null && this._attachedUpdateFunction instanceof Function) {\r\n            this._attachedUpdateFunction();\r\n        }\r\n        this._stage.update();\r\n        this._stage.render(this._renderer);\r\n    }\r\n\r\n    get stage():Stage {\r\n        return this._stage;\r\n    }\r\n\r\n    get renderer():WebGLRenderer {\r\n        return this._renderer;\r\n    }\r\n\r\n    get view():HTMLCanvasElement {\r\n        return this._isInitialized ? this._renderer.view : null;\r\n    }\r\n\r\n    attachUpdateFunction(func:() => void):void {\r\n        this._attachedUpdateFunction = func;\r\n    }\r\n\r\n    private __mainLoop(time:number):void {\r\n        if (!this._isRunning || !this._isInitialized) {\r\n            return;\r\n        }\r\n        this.runOneFrame();\r\n        _util.requestAnimationFrame(this.__mainLoop.bind(this));\r\n    }\r\n\r\n    protected _isRunning:boolean = false;\r\n    protected _renderer:WebGLRenderer = null;\r\n    protected _stage:Stage = null;\r\n    protected _isInitialized:boolean = false;\r\n    protected _attachedUpdateFunction:() => void = null;\r\n\r\n}\r\n"],"sourceRoot":"/source/"}